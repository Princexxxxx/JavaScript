<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Document</title>
    </head>
    <body>
        <script>
            /**
             * 迭代协议
             *
             * 参照可迭代协议，要成为可迭代对象首先要有一个 **@@iterator **即（Symbol.iterator）属性，该属性为一个【无参数的函数】，返回一个符合迭代器协议的对象。
             * 根据迭代器协议定义这个迭代器对象要返回一个 next() 方法，这个 next() 方法返回一个包含 value、done 属性的对象。
             */
            class MyObject {
                #i = 0;

                constructor(items) {
                    this.items = items;
                }

                get length() {
                    return Object.keys(this.items).length;
                }

                // for...of 循环会用到
                [Symbol.iterator]() {
                    return this;
                }

                // 迭代器接口方法
                next() {
                    let done = this.#i >= this.length;

                    let value = !done
                        ? Object.values(this.items)[this.#i++]
                        : undefined;

                    return {
                        done: done,
                        value: value,
                    };
                }
            }

            const obj = new MyObject({
                a: 1,
                b: 2,
                c: 3,
            });

            for (let item of obj) {
                console.log('item -> ', item);
            }
        </script>

        <script>
            // TODO:
            // 基于生成器函数的迭代器实现
            // 使用生成器函数（Generator）实现是最简单的，只要使用 yield 语句返回每一次的值即可。
            // ------------- 自定义迭代器 -------------
            const myIterable = {
                *[Symbol.iterator]() {
                    yield 1;
                    yield 2;
                    yield 3;
                },
            };

            for (let value of myIterable) {
                console.log(value);
            }

            // 或者

            [...myIterable]; // [1, 2, 3]
        </script>
    </body>
</html>
